/**
 * ðŸ›‘ DO NOT EDIT THIS FILE DIRECTLY
 * ----------------------------------
 * This file was generated by ISL Compiler.
 * Source: main.isl.md
 * Edit the ISL file instead.
 */

import React, { useState } from 'react';
import { beautifyJson, copyToClipboard } from './logic';
import { JsonInputArea, JsonOutputArea, BeautifyButton } from './ui';

export default function Main() {
  // Capability: initializeState
  // 1. Initialize `rawJsonState: string` to an empty string.
  // 2. Initialize `beautifiedJsonState: string` to an empty string.
  const [rawJson, setRawJson] = useState('');
  const [beautifiedJson, setBeautifiedJson] = useState('');

  // Capability: handleRawJsonChange
  // 1. Update `rawJsonState` with `newRawJson`.
  const handleRawJsonChange = (newRawJson) => {
    setRawJson(newRawJson);
  };

  // Capability: handleBeautifyRequest
  // 1. Request `JsonBeautifierService.beautifyJson` with `rawJsonState`.
  // 2. Update `beautifiedJsonState` with the result from `JsonBeautifierService.beautifyJson`.
  const handleBeautifyRequest = () => {
    try {
      const result = beautifyJson(rawJson);
      setBeautifiedJson(result);
    } catch (error) {
      // As per Acceptance Criteria: "If the content in JsonInputArea is invalid JSON,
      // clicking "Beautify JSON" displays an error message in JsonOutputArea."
      setBeautifiedJson(`Error: Invalid JSON format.\n${error.message}`);
    }
  };

  // Capability: handleCopyRequest
  // 1. Request `JsonBeautifierService.copyToClipboard` with `beautifiedJsonState`.
  const handleCopyRequest = async () => {
    if (beautifiedJson) { // Ensure there's content to copy
      await copyToClipboard(beautifiedJson);
      // In a real app, you might add a temporary "Copied!" message here.
    }
  };

  return (
    <div className="p-4 max-w-7xl mx-auto">
      <h1 className="text-3xl font-bold text-center mb-6 text-gray-800">JSON Beautifier</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div className="flex flex-col">
          {/* Constraint: The `JsonInputArea` MUST display `rawJsonState`. */}
          {/* Constraint: The `JsonInputArea`'s `onChange` callback MUST be connected to `handleRawJsonChange`. */}
          <JsonInputArea value={rawJson} onChange={handleRawJsonChange} />
        </div>
        <div className="flex flex-col">
          {/* Constraint: The `JsonOutputArea` MUST display `beautifiedJsonState`. */}
          {/* Constraint: The `JsonOutputArea`'s `onCopy` callback MUST be connected to `handleCopyRequest`. */}
          <JsonOutputArea value={beautifiedJson} onCopy={handleCopyRequest} />
        </div>
      </div>
      <div className="flex justify-center mt-8">
        {/* Constraint: The `BeautifyButton`'s `onClick` callback MUST be connected to `handleBeautifyRequest`. */}
        <BeautifyButton onClick={handleBeautifyRequest} />
      </div>
    </div>
  );
}