/**
 * ðŸ›‘ DO NOT EDIT THIS FILE DIRECTLY
 * ----------------------------------
 * This file was generated by ISL Compiler.
 * Source: ui.isl.md
 * Edit the ISL file instead.
 */

import React from 'react';
import { TimerMode, TimerState } from "./domain"; // From REAL IMPLEMENTATION CONTEXT

/**
 * @internal
 * Converts total seconds into a MM:SS string format.
 * @param {number} totalSeconds - The total number of seconds.
 * @returns {string} The formatted time string (MM:SS).
 */
const formatTime = (totalSeconds) => {
  const minutes = Math.floor(totalSeconds / 60);
  const seconds = totalSeconds % 60;

  const formattedMinutes = String(minutes).padStart(2, '0');
  const formattedSeconds = String(seconds).padStart(2, '0');

  return `${formattedMinutes}:${formattedSeconds}`;
};

/**
 * TimerDisplay component for showing the remaining time and current mode.
 * @param {object} props - The component props.
 * @param {number} [props.remainingTime=0] - The time left to display in seconds.
 * @param {'Work'|'ShortBreak'|'LongBreak'} [props.currentMode=TimerMode.Work] - The active timer mode.
 * @param {'Idle'|'Running'|'Paused'|'Completed'} [props.currentState=TimerState.Idle] - The current state of the timer.
 * @returns {React.Element} The TimerDisplay component.
 */
export default function TimerDisplay({ remainingTime = 0, currentMode = TimerMode.Work, currentState = TimerState.Idle }) {
  const formattedTime = formatTime(remainingTime);

  let modeDisplayName = '';
  switch (currentMode) {
    case TimerMode.Work:
      modeDisplayName = 'Work Session';
      break;
    case TimerMode.ShortBreak:
      modeDisplayName = 'Short Break';
      break;
    case TimerMode.LongBreak:
      modeDisplayName = 'Long Break';
      break;
    default:
      modeDisplayName = 'Unknown Mode';
  }

  // Determine text color based on state for visual feedback
  let timeDisplayColorClass = 'text-gray-900'; // Default
  if (currentState === TimerState.Completed) {
    timeDisplayColorClass = 'text-red-500';
  } else if (currentState === TimerState.Paused) {
    timeDisplayColorClass = 'text-yellow-500';
  } else if (currentState === TimerState.Running) {
    timeDisplayColorClass = 'text-green-500';
  }

  return (
    <div className="flex flex-col items-center justify-center p-4 bg-white rounded-lg shadow-md">
      <div className={`text-6xl font-bold ${timeDisplayColorClass} mb-2`}>
        {formattedTime}
      </div>
      <div className="text-xl text-gray-600">
        {modeDisplayName}
      </div>
    </div>
  );
}

/**
 * ControlButtons component for managing timer actions and mode selection.
 * @param {object} props - The component props.
 * @param {'Idle'|'Running'|'Paused'|'Completed'} [props.currentState=TimerState.Idle] - The current state of the timer.
 * @param {() => void} [props.onStart=() => {}] - Callback to trigger timer start.
 * @param {() => void} [props.onPause=() => {}] - Callback to trigger timer pause.
 * @param {() => void} [props.onReset=() => {}] - Callback to trigger timer reset.
 * @param {(mode: 'Work'|'ShortBreak'|'LongBreak') => void} [props.onSelectMode=() => {}] - Callback to trigger mode selection.
 * @returns {React.Element} The ControlButtons component.
 */
export function ControlButtons({
  currentState = TimerState.Idle,
  onStart = () => {},
  onPause = () => {},
  onReset = () => {},
  onSelectMode = () => {}
}) {
  const isStartDisabled = currentState === TimerState.Running;
  const isPauseDisabled = currentState === TimerState.Idle || currentState === TimerState.Paused || currentState === TimerState.Completed;
  // "Reset" button MUST be enabled in all states except Idle (unless it's also the only way to exit Completed).
  // This implies it should be enabled in Completed. So, disabled only if Idle.
  const isResetDisabled = currentState === TimerState.Idle;
  const isModeSelectionDisabled = currentState === TimerState.Running;

  const getButtonClass = (isDisabled) => {
    let baseClass = "px-4 py-2 rounded-md font-medium transition-colors duration-200 ";
    if (isDisabled) {
      return baseClass + "bg-gray-200 text-gray-400 cursor-not-allowed";
    }
    return baseClass + "bg-blue-500 text-white hover:bg-blue-600";
  };

  const getModeButtonClass = (mode) => {
    let baseClass = "px-4 py-2 rounded-md font-medium transition-colors duration-200 ";
    if (isModeSelectionDisabled) {
      return baseClass + "bg-gray-200 text-gray-400 cursor-not-allowed";
    }
    // No 'active' state for mode buttons specified in ISL based on currentMode,
    // so just apply enabled style.
    return baseClass + "bg-gray-300 text-gray-800 hover:bg-gray-400";
  };

  return (
    <div className="flex flex-col items-center p-4 bg-white rounded-lg shadow-md space-y-4">
      <div className="flex space-x-2">
        <button
          onClick={onStart}
          disabled={isStartDisabled}
          className={getButtonClass(isStartDisabled)}
        >
          {currentState === TimerState.Paused || currentState === TimerState.Idle ? "Start" : "Resume"}
        </button>
        <button
          onClick={onPause}
          disabled={isPauseDisabled}
          className={getButtonClass(isPauseDisabled)}
        >
          Pause
        </button>
        <button
          onClick={onReset}
          disabled={isResetDisabled}
          className={getButtonClass(isResetDisabled)}
        >
          Reset
        </button>
      </div>

      <div className="flex space-x-2">
        <button
          onClick={() => onSelectMode(TimerMode.Work)}
          disabled={isModeSelectionDisabled}
          className={getModeButtonClass(TimerMode.Work)}
        >
          Work
        </button>
        <button
          onClick={() => onSelectMode(TimerMode.ShortBreak)}
          disabled={isModeSelectionDisabled}
          className={getModeButtonClass(TimerMode.ShortBreak)}
        >
          Short Break
        </button>
        <button
          onClick={() => onSelectMode(TimerMode.LongBreak)}
          disabled={isModeSelectionDisabled}
          className={getModeButtonClass(TimerMode.LongBreak)}
        >
          Long Break
        </button>
      </div>
    </div>
  );
}